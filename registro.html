<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Crear cuenta</title>
  <link rel="stylesheet" href="style.css">
  <script>
    function toggleImpresoraField() {
      const checkbox = document.getElementById('impresor');
      const impresoraField = document.getElementById('impresora-modelo');
      impresoraField.style.display = checkbox.checked ? 'block' : 'none';
    }

    function guardarYRedirigir(event) {
      event.preventDefault();

      const nombre = document.getElementById('nombre').value;
      const usuario = document.getElementById('usuario').value;
      const correo = document.getElementById('correo').value;
      const roles = [];
      if (document.getElementById('creador').checked) roles.push('creador');
      if (document.getElementById('impresor').checked) roles.push('impresor');
      if (document.getElementById('usuarioCheck').checked) roles.push('usuario');
      const impresora = document.getElementById('impresora-modelo-input').value;

      const nuevoUsuario = {
        nombre,
        usuario,
        correo,
        roles,
        impresora
      };

      // Simular base de datos local
      const baseUsuarios = JSON.parse(localStorage.getItem('usuarios')) || [];
      baseUsuarios.push(nuevoUsuario);
      localStorage.setItem('usuarios', JSON.stringify(baseUsuarios));

      // Guardar el usuario actual por separado (para gustos.html)
      localStorage.setItem('datosRegistro', JSON.stringify(nuevoUsuario));

      window.location.href = 'gustos.html';
    }
  </script>
</head>
<body>
  <button onclick="history.back()" class="back-button">← Volver</button>
  <div class="register-box">
    <h2>Crear cuenta</h2>
    <form onsubmit="guardarYRedirigir(event)">
      <input type="text" id="nombre" placeholder="Nombre completo" required />
      <input type="text" id="usuario" placeholder="Nombre de usuario" required />
      <input type="email" id="correo" placeholder="Correo electrónico" required />
      <input type="password" placeholder="Contraseña" required />
      <input type="password" placeholder="Confirmar contraseña" required />

      <label><input type="checkbox" id="creador" value="creador"> Creador</label><br>
      <label><input type="checkbox" id="impresor" value="impresor" onchange="toggleImpresoraField()"> Impresor</label><br>
      <div id="impresora-modelo" style="display:none;">
        <input type="text" id="impresora-modelo-input" placeholder="Modelo de impresora" />
      </div>
      <label><input type="checkbox" id="usuarioCheck" value="usuario"> Usuario</label><br><br>

      <label>Subir foto de perfil:</label><br>
      <input type="file" accept="image/*"><br><br>

      <button type="submit">Registrarse</button>
    </form>
  </div>
</body>
</html>
